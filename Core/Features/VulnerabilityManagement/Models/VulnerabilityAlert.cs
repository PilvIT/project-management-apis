using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using Core.Features.Projects.Models;
using Microsoft.EntityFrameworkCore;

namespace Core.Features.VulnerabilityManagement.Models;

[Index(nameof(PackageName), nameof(ManifestPath), nameof(DescriptionLink), IsUnique = true)]
public class VulnerabilityAlert : BaseModel
{
    [StringLength(200)]
    public string PackageName { get; set; } = null!;

    [StringLength(200)]
    public string Ecosystem { get; set; } = null!;

    [Url]
    public string DescriptionLink { get; set; } = null!;

    [StringLength(50)]
    public string VulnerableVersions { get; set; } = null!;

    [StringLength(50)]
    public string PatchedVersion { get; set; } = null!;

    [StringLength(500)]
    public string ManifestPath { get; set; } = null!;
    
    public double CvssScore { get; set; }
    public bool IsTransitive { get; set; }
    
    public DateTime CreatedAt { get; set; }

    [ForeignKey(nameof(GitRepository))]
    public Guid RepositoryId { get; set; }
    public GitRepository? Repository { get; set; }
    
    [ForeignKey(nameof(IssueLog))]
    public Guid IssueLogId { get; set; }
}

public class VulnerabilityAlertConfiguration : BaseModelConfiguration<VulnerabilityAlert>
{
    
}
